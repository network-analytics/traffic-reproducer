---
pcap: ["capture1.pcap", "capture2.pcap"]    # TODO implement here list support (caps are simply merged in this order)

pcap_processing:
  exit: yes                         # mandatory, default=no, if yes do not reproduce (only perform the pcap_processing then exit) [still to implement most stuff]
  anonymize: yes                    # if yes=change all in-protocol IPs/MAC_addresses to random ones (use some random ips and mac addresses)
  inter_packet_delay: 0.001         # not mandatory, seconds [default:1ms]
  inter_protocol_delay: 1           # not mandatory, seconds [default:1s]
  output_folder: /tmp               # not mandatory, if not present use pcap name without extention as folder name
  bgp_defrag: yes                   # [valid also for bgp extracted from BMP] defaults to yes but with this flag we could disable if not working in some scenarios
                                    # --> this would impact capability of gathering stats and anonymizing (but still we are able to gather details for OPEN msg at least)
   
  # Implement only if there is time (also maybe useful to extend for e.g. repeating bmp stats etc. to test mem leaks)
  ipfix_repeat:
    amount: 5                       # add the same packets again 5x times
    sleep: 60                       # every time adding 60s to the timestamps before sending them again
    mixup: yes                      # apart from template, mix up the order of the packets
    randomize_counts: yes           # for the repetitions, randomize some of the fields like count, bytes [s.t. subsequent runs are not 100% the same]

network:
  # repro src_ip mapping --> only needed when pcap_processing[exit]: no
  map: 
    - src_ip:         10.235.1.3
      repro_ip:       172.1.100.1   
    - src_ip:         10.254.2.4
      repro_ip:       172.1.100.2

# TODO: change like here (bgp->BGP) -> requires change also in proto.py (s.t. we can distinguish from selector entries)
# --> and also for maximum understanding maybe change bgp->bgp_h etc... (no, brutto...)
# --> da vedere, se decido di rimuoverlo dai filtri magari neanche cambiare (per√≤ non penso, perche soprattutto tipo per escludere  bmp stats potrebbe essere utile...)
BGP:  
  select: 
    ip:
      src: [10.235.1.3, 10.254.2.4]
    tcp:
      dport: 179 
    bgp: 
      type: [1, 2, 4]            # 1:OPEN 2:UPDATE 3:NOTIFICATION 4:KEEPALIVE 5:ROUTE-REFRESH (TODO: improve or remove this (as we could e.g. have keepalives + updates in same packet and currently this would discard whole packet...))

BMP:
  select: 
    ip:
      src: [10.235.1.3, 10.254.2.4]
    tcp:
      dport: 1790
    bmp:
      type: [0, 2, 3, 4, 5]      #  0:ROUTE_MONITORING 1:STATS 2:PEER_DOWN 3:PEER_UP 4:INIT 5:TERM 6:ROUTE_MIRRORING (TODO: same reasoning as for bgp)

IPFIX:
  select:
    ip:
      src: [10.235.1.3, 10.254.2.4]
    udp:
      dport: 9991
    cflow:
      version: [10, 9, 5]
      
