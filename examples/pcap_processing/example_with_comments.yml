---
pcap: ["capture1.pcap", "capture2.pcap"]    # TODO implement here list support! (pcaps are simply merged in this order, then processed...--> only for pre-processing)

pcap_processing:
  exit: yes                         # mandatory, default=no, if yes do not reproduce (only perform the pcap_processing then exit) [still to implement most stuff]
  anonymize: yes                    # if yes=change all in-protocol IPs/MAC_addresses to random ones (use some random ips and mac addresses)
  inter_packet_delay: 0.001         # not mandatory, seconds [default:1ms]
  inter_protocol_delay: 1           # not mandatory, seconds [default:1s]
  output_folder: /tmp               # not mandatory, if not present use pcap name without extention as folder name
   
  # Implement only if there is time
  ipfix_repeat:
    amount: 5                       # add the same packets again 5x times
    sleep: 60                       # every time adding 60s to the timestamps before sending them again
    mixup: yes                      # apart from template, mix up the order of the packets
    randomize_counts: yes           # for the repetitions, randomize some of the fields like count, bytes [s.t. subsequent runs are not 100% the same]

network:
  # input -> output pcap src_ip mapping  (dst_ip set to 0.0.0.0 anyway as not considered by the traffic-reproducer)
  #  --> repro_ip used for repro only [pre-processing does not change src-ip]
  # TODO: maybe it is even better to use the IP selector to select packets for pre-processing (then the network field is not even used for pre-processing)
  map: 
    - src_ip:         10.235.1.3
      repro_ip:       172.1.100.1   
    - src_ip:         10.254.2.4
      repro_ip:       172.1.100.2

bgp:
  select: 
    ip:
      src: [10.235.1.3, 10.254.2.4]
    tcp:
      dport: 179 
    bgp: 
      type: [1, 2, 4]            # 1:OPEN 2:UPDATE 3:NOTIFICATION 4:KEEPALIVE 5:ROUTE-REFRESH

bmp:
  select: 
    ip:
      src: [10.235.1.3, 10.254.2.4]
    tcp:
      dport: 1790
    bmp:
      type: [0, 2, 3, 4, 5]      #  0:ROUTE_MONITORING 1:STATS 2:PEER_DOWN 3:PEER_UP 4:INIT 5:TERM 6:ROUTE_MIRRORING

ipfix:
  select:
    ip:
      src: [10.235.1.3, 10.254.2.4]
    udp:
      dport: 9991
    cflow:
      version: [10, 9, 5]
      
